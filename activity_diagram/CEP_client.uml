@startuml
start
:SST Client: Intiailize device & show screen;

fork

repeat:Fetch image;
  :Recognize faces;

  :Count enrolled faces;

  if (count == 0) then (yes)
    :Close any
     open session;
  else (no)
    :Choose
     top-rank face;
    if (Different face\n from Session?) then (yes)
      :Greet user;
    else (no)
    endif
    :Renew session;
  endif
repeat while (quit?) is (no)

fork again

repeat:Fetch sound;
  :Recognize voice;

  if ("wakeup word"?) then (no)
  else (yes)
    :Record following\n command;
    :Send command\nto a voice\n **smart service**;
    :Get response\nfrom the service;
    :Perform its action;
  endif
repeat while (quit?) is (no)

fork again

while (CPU idle?) is (yes)
  :Gather user
   activity & log;
  :send to
   to Cloud;
endwhile

fork again

repeat:Receive an Request;

  -> if the "Request" is;

  if ("Sign Up SST") then (yes)
    repeat:Start 'Enroll Face';
      :Fetch image;
      :Count 
       unenrolled faces;
    repeat while (count == 1) is (no)
    :Store face
     features in Anaytics;
    :Receive
     User info.;
    :Send user profile
     to Cloud;
    :Welcome new user;
  elseif ("Browse Service") then (yes)
    :Get service list
    from Cloud;

    :Show Smart
     Services;
  elseif ("Manage Service") then (yes)
    :Manage Service;
  elseif ("Manage
   User Profile") then (yes)
    :Manage
    User Profile;
  elseif ("Broadcast
   TV Channels
   for Broadcast/Cable") then (yes)
    :Get channel list;

    :Show TV Channels
     for Broadcast/Cable;
  else (Handle other
   requests)
  endif

repeat while (quit?) is (no)
 

endfork

stop
@enduml